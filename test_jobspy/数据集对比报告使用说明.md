# 数据集对比报告使用说明

## 脚本功能

`compare_datasets.py` 用于对比两个不同时间点的数据集，生成详细的对比分析报告。

### 主要对比维度

1. **职业数量对比**
   - 各地区职位总数对比
   - 职位数量变化百分比
   - 总体趋势分析

2. **薪资水平对比**
   - 整体薪资统计（均值、中位数、分位数）
   - 各地区薪资对比
   - 薪资变化趋势

3. **行业/职业类别占比对比**
   - 职业类别分布（AI/ML Engineer, Data Scientist, Software Engineer等）
   - 各类别占比变化
   - 行业趋势分析

4. **平台分布对比**
   - Indeed vs LinkedIn 分布对比
   - 平台占比变化

5. **地理位置分布对比**
   - 热门城市/地区对比
   - 地理分布变化

## 配置方法

### 在脚本顶部配置（推荐）

打开 `compare_datasets.py`，修改以下配置：

```python
# ============================================================================
# COMPARISON CONFIGURATION - Modify these settings as needed
# ============================================================================

# Paths to the two datasets to compare
DATASET1_PATH = "output/BunchGlobal_2025_12_26"
DATASET2_PATH = "output/BunchGlobal_2025_01_18"

# Dataset labels (for display in report)
DATASET1_LABEL = "December 2025"
DATASET2_LABEL = "January 2025"
```

### 配置说明

- **DATASET1_PATH**: 第一个数据集的文件夹路径（通常是较早的数据）
- **DATASET2_PATH**: 第二个数据集的文件夹路径（通常是较新的数据）
- **DATASET1_LABEL**: 第一个数据集的显示标签（用于报告中的标题）
- **DATASET2_LABEL**: 第二个数据集的显示标签（用于报告中的标题）

## 使用方法

### 基本用法

配置好路径后，直接运行：

```bash
python compare_datasets.py
```

无需任何命令行参数！

## 文件夹结构要求

两个数据集文件夹都应该包含以下结构：

```
output/BunchGlobal_2025_12_26/
    united_states/
        jobspy_max_output.xlsx
    united_kingdom/
        jobspy_max_output.xlsx
    australia/
        jobspy_max_output.xlsx
    hong_kong/
        jobspy_max_output.xlsx
    singapore/
        jobspy_max_output.xlsx
```

## 输出说明

### 报告位置

报告保存在：`output/reports/comparison_report_{数据集1}_{数据集2}_{时间戳}.docx`

### 报告内容

1. **执行摘要**
   - 总体统计对比
   - 主要变化趋势

2. **总体统计对比表**
   - 总职位数对比
   - 有数据的地区数量对比

3. **各地区职位数量对比**
   - 每个地区的职位数
   - 变化百分比

4. **薪资对比分析**
   - 整体薪资统计对比
   - 各地区薪资详细对比
   - 均值、中位数、分位数对比

5. **职业类别/行业对比**
   - 各类别职位数量对比
   - 类别占比对比
   - 变化趋势

6. **平台分布对比**
   - Indeed vs LinkedIn 分布
   - 平台占比变化

7. **可视化图表**
   - 薪资分布对比图（箱线图 + 柱状图）
   - 职位数量对比图（柱状图 + 变化百分比）
   - 职业类别分布对比图（数量 + 百分比）

## 示例

### 对比 12月 和 1月 的数据

```python
DATASET1_PATH = "output/BunchGlobal_2025_12_26"
DATASET2_PATH = "output/BunchGlobal_2025_01_18"
DATASET1_LABEL = "December 2025"
DATASET2_LABEL = "January 2025"
```

运行：
```bash
python compare_datasets.py
```

## 职业类别分类

脚本会自动将职位标题分类为以下类别：

- **AI/ML Engineer**: AI工程师、机器学习工程师等
- **Data Scientist/Analyst**: 数据科学家、数据分析师
- **AI Specialist (NLP/CV)**: NLP、计算机视觉专家
- **AI Product/Management**: AI产品经理、AI管理
- **AI Architecture**: AI架构师
- **AI Research**: AI研究员
- **Software Engineer**: 软件工程师
- **Senior/Lead Engineer**: 高级/首席工程师
- **Product Manager**: 产品经理
- **Data Engineer**: 数据工程师
- **DevOps/SRE**: DevOps、SRE
- **QA/Testing**: 测试工程师
- **Other**: 其他

## 注意事项

1. **数据格式要求**：Excel文件必须包含标准列名（Job Title, Company Name, Location等）

2. **文件夹结构**：每个数据集文件夹下必须有地区子文件夹，每个子文件夹包含 `jobspy_max_output.xlsx`

3. **缺失数据**：如果某个地区在某个数据集中缺失，脚本会跳过并继续处理

4. **薪资数据**：薪资分析仅基于有效的USD薪资数据（10,000 - 500,000范围）

5. **报告生成时间**：根据数据量大小，可能需要几分钟时间

## 故障排除

### 错误：Folder does not exist
- 检查文件夹路径是否正确
- 确保使用相对路径或绝对路径

### 警告：No data found
- 检查Excel文件是否存在
- 检查Excel文件是否包含数据

### 报告为空或缺少数据
- 检查两个数据集是否都有数据
- 检查列名是否正确
- 检查数据格式是否符合要求

## 与 generate_local_report.py 的区别

| 特性 | generate_local_report.py | compare_datasets.py |
|------|-------------------------|---------------------|
| 功能 | 单数据集分析 | 双数据集对比 |
| 数据源 | 一个文件夹 | 两个文件夹 |
| 输出 | 详细分析报告 | 对比分析报告 |
| 图表 | 单数据集统计图表 | 对比图表 |
| 用途 | 了解单个数据集特征 | 了解数据变化趋势 |

